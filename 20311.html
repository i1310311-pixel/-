<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>ğŸ„ è–èª•å°„æ“ŠéŠæˆ²</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    background: linear-gradient(#0a2a66, #0f4fa8);
    font-family: Arial, sans-serif;
}

/* HUD */
#hud {
    position: fixed;
    top: 12px;
    left: 12px;
    padding: 8px 14px;
    background: rgba(0,0,0,0.4);
    border-radius: 12px;
    color: white;
    font-size: 18px;
    z-index: 10;
}

/* ç•«é¢é®ç½© */
.overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.65);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 100;
}

.card {
    background: #1c2f66;
    border-radius: 18px;
    padding: 32px 40px;
    width: 420px;
    color: white;
    text-align: center;
}

.card h1 {
    margin-bottom: 10px;
    font-size: 34px;
}

.card p {
    font-size: 16px;
    line-height: 1.6;
    margin: 6px 0;
}

.card button {
    width: 200px;
    margin: 10px 0;
    padding: 12px;
    font-size: 18px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
}

/* éŠæˆ²å…ƒç´  */
#gameArea {
    position: relative;
    width: 100%;
    height: 100%;
}

#player {
    position: fixed;
    bottom: 10px;
    font-size: 42px;
    pointer-events: none;
}

.enemy { position: absolute; font-size: 36px; }
.bullet { position: absolute; font-size: 22px; }
.boss { position: absolute; font-size: 72px; }
.snow { position: fixed; top: -10px; color: white; pointer-events: none; }
</style>
</head>

<body>

<!-- é–‹å§‹ç•«é¢ -->
<div id="startScreen" class="overlay">
    <div class="card">
        <h1>ğŸ„ è–èª•å°„æ“Š</h1>
        <p>ğŸ¯ ç›®æ¨™ï¼šåœ¨æ™‚é–“å…§é”æˆæŒ‡å®šåˆ†æ•¸</p>
        <p>ğŸ ç¦®ç‰© +1ã€€ğŸ’£ ç‚¸å½ˆ -2</p>
        <p>ğŸ‘¹ Boss æ‰“å€’å¯ç²å¾—å¤§é‡åˆ†æ•¸</p>
        <hr>
        <p>ğŸŸ¢ ç°¡å–®ï¼š60 ç§’ï½œç›®æ¨™ 60 åˆ†</p>
        <p>ğŸ”µ æ™®é€šï¼š50 ç§’ï½œç›®æ¨™ 40 åˆ†</p>
        <p>ğŸ”´ å›°é›£ï¼š40 ç§’ï½œç›®æ¨™ 20 åˆ†</p>
        <button onclick="startGame('easy')">ç°¡å–®</button>
        <button onclick="startGame('normal')">æ™®é€š</button>
        <button onclick="startGame('hard')">å›°é›£</button>
    </div>
</div>

<!-- çµæœç•«é¢ -->
<div id="resultScreen" class="overlay" style="display:none;">
    <div class="card">
        <h1 id="resultTitle"></h1>
        <p id="resultText"></p>
        <button onclick="location.reload()">å†ç©ä¸€æ¬¡</button>
    </div>
</div>

<div id="hud">
    åˆ†æ•¸ï¼š<span id="score">0</span>ï½œ
    æ™‚é–“ï¼š<span id="time">0</span>s
    <span id="bossHp"></span>
</div>

<div id="gameArea"></div>
<div id="player">ğŸ…</div>

<script>
const gameArea = document.getElementById("gameArea");
const scoreText = document.getElementById("score");
const timeText = document.getElementById("time");
const bossHpText = document.getElementById("bossHp");
const player = document.getElementById("player");

let started = false;
let score = 0;
let timeLeft = 0;
let targetScore = 0;
let enemies = [];
let boss = null;
let bossHP = 0;
let timerId;
let bossDirection = 1; // Boss æ°´å¹³ç§»å‹•æ–¹å‘

/* é›£åº¦åƒæ•¸ */
let enemySpeed = 3;
let spawnRate = 700;
let bombRate = 0.3;
let bossMaxHP = 18;

/* é›ª */
let snowCount = 0;
const MAX_SNOW = 40;

function startGame(level) {
    document.getElementById("startScreen").style.display = "none";
    started = true;
    score = 0;
    enemies = [];
    boss = null;
    bossHpText.textContent = "";

    if (level === "easy") {
        timeLeft = 60; targetScore = 60;
        enemySpeed = 2; spawnRate = 900; bombRate = 0.2; bossMaxHP = 12;
    } else if (level === "normal") {
        timeLeft = 50; targetScore = 40;
        enemySpeed = 3; spawnRate = 700; bombRate = 0.3; bossMaxHP = 18;
    } else { // å›°é›£æ¨¡å¼
        timeLeft = 40; 
        targetScore = 20; // ç›®æ¨™åˆ†æ•¸æ”¹ç‚º 20
        enemySpeed = 3; 
        spawnRate = 650; 
        bombRate = 0.35;  
        bossMaxHP = 18;  
    }

    scoreText.textContent = 0;
    timeText.textContent = timeLeft;

    timerId = setInterval(() => {
        timeLeft--;
        timeText.textContent = timeLeft;
        if (timeLeft <= 0) endGame();
    }, 1000);

    setInterval(spawnEnemy, spawnRate);
    setInterval(checkBoss, 800);
    setInterval(createSnow, 180);
    setInterval(() => { if(boss) moveBoss(); }, 16); // Boss ç§»å‹•
}

function endGame() {
    started = false;
    clearInterval(timerId);
    document.getElementById("resultScreen").style.display = "flex";
    const win = score >= targetScore;
    document.getElementById("resultTitle").textContent = win ? "ğŸ‰ æˆåŠŸï¼" : "ğŸ˜¢ å¤±æ•—";
    document.getElementById("resultText").textContent =
        `ä½ çš„åˆ†æ•¸ï¼š${score} ï¼ ç›®æ¨™ï¼š${targetScore}`;
}

/* æ§åˆ¶ */
window.addEventListener("mousemove", e => {
    if (started) player.style.left = e.clientX - 20 + "px";
});

window.addEventListener("mousedown", e => {
    if (started) shoot(e.clientX);
});

/* å°„æ“Š */
function shoot(x) {
    const bullet = document.createElement("div");
    bullet.className = "bullet";
    bullet.textContent = "â„";
    bullet.style.left = x + "px";
    bullet.style.top = innerHeight - 70 + "px";
    gameArea.appendChild(bullet);

    let y = innerHeight - 70;
    const t = setInterval(() => {
        y -= 12;
        bullet.style.top = y + "px";

        if (boss) {
            const r = boss.getBoundingClientRect();
            if (x > r.left && x < r.right && y > r.top && y < r.bottom) {
                bossHP--;
                bossHpText.textContent = ` ï½œ ğŸ‘¹ HP:${bossHP}`;
                bullet.remove(); clearInterval(t);
                if (bossHP <= 0) {
                    score += 15;
                    scoreText.textContent = score;
                    boss.remove(); boss = null;
                    bossHpText.textContent = "";
                }
                return;
            }
        }

        for (let i = enemies.length - 1; i >= 0; i--) {
            const e = enemies[i];
            const r = e.getBoundingClientRect();
            if (x > r.left && x < r.right && y > r.top && y < r.bottom) {
                score += e.dataset.type === "gift" ? 1 : -2;
                scoreText.textContent = score;
                e.remove(); enemies.splice(i, 1);
                bullet.remove(); clearInterval(t);
                return;
            }
        }

        if (y < 0) { bullet.remove(); clearInterval(t); }
    }, 16);
}

/* æ•µäºº */
function spawnEnemy() {
    if (!started || boss) return;
    const e = document.createElement("div");
    e.className = "enemy";
    const gift = Math.random() > bombRate;
    e.textContent = gift ? "ğŸ" : "ğŸ’£";
    e.dataset.type = gift ? "gift" : "bomb";
    e.style.left = Math.random() * (innerWidth - 40) + "px";
    e.style.top = "-40px";
    gameArea.appendChild(e);
    enemies.push(e);

    let y = -40;
    const f = setInterval(() => {
        y += enemySpeed;
        e.style.top = y + "px";
        if (y > innerHeight) {
            e.remove(); clearInterval(f);
            enemies = enemies.filter(x => x !== e);
        }
    }, 20);
}

/* Boss */
function checkBoss() {
    if (score > 0 && score % 20 === 0 && !boss) {
        boss = document.createElement("div");
        boss.className = "boss";
        boss.textContent = "ğŸ‘¹";
        bossHP = bossMaxHP;
        bossHpText.textContent = ` ï½œ ğŸ‘¹ HP:${bossHP}`;
        boss.style.left = "40%";
        boss.style.top = "70px";
        gameArea.appendChild(boss);
    }
}

/* Boss æ°´å¹³ç§»å‹• */
function moveBoss() {
    const step = 2; // æ¯æ¬¡ç§»å‹• 2px
    let left = boss.offsetLeft + step * bossDirection;

    if (left < 0) bossDirection = 1;
    if (left > window.innerWidth - boss.offsetWidth) bossDirection = -1;

    boss.style.left = boss.offsetLeft + step * bossDirection + "px";
}

/* é›ª */
function createSnow() {
    if (!started || snowCount >= MAX_SNOW) return;
    snowCount++;
    const s = document.createElement("div");
    s.className = "snow";
    s.textContent = "â„";
    s.style.left = Math.random() * innerWidth + "px";
    s.style.fontSize = Math.random() * 8 + 12 + "px";
    document.body.appendChild(s);

    let y = -10;
    const f = setInterval(() => {
        y += 1.5;
        s.style.top = y + "px";
        if (y > innerHeight) {
            s.remove(); clearInterval(f); snowCount--;
        }
    }, 30);
}
</script>

</body>
</html>
s
